(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["foodList"],{"39bc":function(e,t,a){"use strict";var s=a("e9ab"),n=a.n(s);n.a},5370:function(e,t,a){"use strict";var s=a("84e0"),n=a.n(s);n.a},"84e0":function(e,t,a){},"8cc2":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fillcontain"},[a("head-top"),a("div",{staticClass:"table_container"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"dragTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"row-key":"foodId",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",label:"食品ID",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.foodId))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"食品名称",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.name))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"食品介绍"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.description))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"食品分类",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.categoryName))])]}}])}),a("el-table-column",{attrs:{label:"操作",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"small"},on:{click:function(a){return e.handleEdit(t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(a){return e.handleDelete(t.row)}}},[e._v("删除")])]}}])}),a("el-table-column",{attrs:{align:"center",label:"拖拽",width:"100"}},[[a("i",{staticClass:" iconfont icon-drag",staticStyle:{"font-size":"25px"}})]],2)],1),a("div",{staticClass:"Pagination"},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":20,layout:"total, prev, pager, next",total:e.count},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),a("el-dialog",{attrs:{title:"修改食品信息",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{attrs:{model:e.selectTable}},[a("el-form-item",{attrs:{label:"食品名称","label-width":"100px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.selectTable.name,callback:function(t){e.$set(e.selectTable,"name",t)},expression:"selectTable.name"}})],1),a("el-form-item",{attrs:{label:"食品介绍","label-width":"100px"}},[a("el-input",{model:{value:e.selectTable.description,callback:function(t){e.$set(e.selectTable,"description",t)},expression:"selectTable.description"}})],1)],1),a("el-row",{staticStyle:{overflow:"auto","text-align":"center"}},[a("el-table",{staticStyle:{"margin-bottom":"20px"},attrs:{data:e.specs,"row-class-name":e.tableRowClassName}},[a("el-table-column",{attrs:{prop:"specs",label:"规格"}}),a("el-table-column",{attrs:{prop:"price",label:"价格"}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(a){return e.deleteSpecs(t.$index)}}},[e._v("删除")])]}}])})],1),a("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"primary"},on:{click:function(t){e.specsFormVisible=!0}}},[e._v("添加规格")])],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.updateFood}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"添加规格",visible:e.specsFormVisible},on:{"update:visible":function(t){e.specsFormVisible=t}}},[a("el-form",{attrs:{rules:e.specsFormrules,model:e.specsForm}},[a("el-form-item",{attrs:{label:"规格","label-width":"100px",prop:"specs"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.specsForm.specs,callback:function(t){e.$set(e.specsForm,"specs",t)},expression:"specsForm.specs"}})],1),a("el-form-item",{attrs:{label:"价格","label-width":"100px"}},[a("el-input-number",{attrs:{precision:2,step:.1,min:0,max:1e4},model:{value:e.specsForm.price,callback:function(t){e.$set(e.specsForm,"price",t)},expression:"specsForm.price"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.specsFormVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.addspecs}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"提示",visible:e.dialogDeleteVisible,width:"30%",center:""},on:{"update:visible":function(t){e.dialogDeleteVisible=t}}},[a("span",[e._v('确定要删除"'+e._s(e.currentRow.name)+'"吗?')]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogDeleteVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"danger"},on:{click:e.confirmDeleteButton}},[e._v("删 除")])],1)])],1)],1)},n=[],r=(a("7f7f"),a("ac4d"),a("8a81"),a("96cf"),a("3b8d")),i=(a("ac6a"),a("cebc")),o=a("cc54"),l=a("2f62"),c=a("51be"),u=a("aa47"),p=a("aac5"),d={data:function(){return{baseUrl:c["a"],imgBaseUrl:c["b"],restaurant_id:null,city:{},offset:0,limit:20,count:0,tableData:[],currentPage:1,selectTable:{},dialogFormVisible:!1,menuOptions:[],selectMenu:{},selectIndex:null,specsForm:{specs:"",price:0},specsFormrules:{specs:[{required:!0,message:"请输入规格",trigger:"blur"}]},specsFormVisible:!1,expendRow:[],listLoading:!0,sortable:null,dialogDeleteVisible:!1,currentRow:{}}},created:function(){},mounted:function(){this.initData()},computed:Object(i["a"])({},Object(l["d"])(["userInfo","restaurantInfo"]),{specs:function(){var e=[];return this.selectTable.specfoods&&this.selectTable.specfoods.forEach(function(t){e.push({specs:t.specsName,price:t.price})}),e}}),components:{headTop:o["a"]},methods:{initData:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t,a,s,n,r,i,o,l,c,u,d,b,f,m,h,g,v,w,x,y,k,_=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(p["p"])({restaurantId:this.userInfo.restaurantId});case 3:t=e.sent,a=[],s=!0,n=!1,r=void 0,e.prev=8,i=t.data[Symbol.iterator]();case 10:if(s=(o=i.next()).done){e.next=62;break}l=o.value,c=!0,u=!1,d=void 0,e.prev=15,b=l.foods[Symbol.iterator]();case 17:if(c=(f=b.next()).done){e.next=45;break}for(m=f.value,h=[],g=!0,v=!1,w=void 0,e.prev=23,x=m.specfoods[Symbol.iterator]();!(g=(y=x.next()).done);g=!0)k=y.value,h.push({specs:k.specsName,price:k.price});e.next=31;break;case 27:e.prev=27,e.t0=e["catch"](23),v=!0,w=e.t0;case 31:e.prev=31,e.prev=32,g||null==x.return||x.return();case 34:if(e.prev=34,!v){e.next=37;break}throw w;case 37:return e.finish(34);case 38:return e.finish(31);case 39:m.categoryName=l.name,m.specs=h,a.push(m);case 42:c=!0,e.next=17;break;case 45:e.next=51;break;case 47:e.prev=47,e.t1=e["catch"](15),u=!0,d=e.t1;case 51:e.prev=51,e.prev=52,c||null==b.return||b.return();case 54:if(e.prev=54,!u){e.next=57;break}throw d;case 57:return e.finish(54);case 58:return e.finish(51);case 59:s=!0,e.next=10;break;case 62:e.next=68;break;case 64:e.prev=64,e.t2=e["catch"](8),n=!0,r=e.t2;case 68:e.prev=68,e.prev=69,s||null==i.return||i.return();case 71:if(e.prev=71,!n){e.next=74;break}throw r;case 74:return e.finish(71);case 75:return e.finish(68);case 76:this.count=t.count,this.tableData=a,this.listLoading=!1,this.$nextTick(function(){_.setSort()}),e.next=85;break;case 82:e.prev=82,e.t3=e["catch"](0),console.log("获取数据失败",e.t3);case 85:case"end":return e.stop()}},e,this,[[0,82],[8,64,68,76],[15,47,51,59],[23,27,31,39],[32,,34,38],[52,,54,58],[69,,71,75]])}));function t(){return e.apply(this,arguments)}return t}(),tableRowClassName:function(e,t){return 1===t?"info-row":3===t?"positive-row":""},addspecs:function(){this.specs.push(Object(i["a"])({},this.specsForm)),this.specsForm.specs="",this.specsForm.price=20,this.specsFormVisible=!1},deleteSpecs:function(e){this.specs.splice(e,1)},handleSizeChange:function(e){console.log("每页 ".concat(e," 条"))},handleCurrentChange:function(e){this.currentPage=e,this.offset=(e-1)*this.limit,this.getMenu()},handleEdit:function(e){this.getSelectItemData(e,"edit"),this.dialogFormVisible=!0},getSelectItemData:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t,a){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.selectTable=Object(i["a"])({},t,{restaurantName:this.restaurantInfo.name,restaurantAddress:this.restaurantInfo.address,categoryName:t.categoryName}),this.selectMenu={label:t.categoryName,value:t.categoryId},this.initData();case 3:case"end":return e.stop()}},e,this)}));function t(t,a){return e.apply(this,arguments)}return t}(),handleSelect:function(e){this.selectIndex=null,this.selectMenu=this.menuOptions[e]},handleDelete:function(e){this.currentRow=e,this.dialogDeleteVisible=!0},confirmDeleteButton:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t,a=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(p["j"])({foodId:this.currentRow.foodId});case 3:t=e.sent,this.$message({type:"success",message:t.message}),this.dialogDeleteVisible=!1,this.tableData=this.tableData.filter(function(e){return e.foodId!==a.currentRow.foodId}),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](0),this.$message({type:"error",message:e.t0.message});case 12:case"end":return e.stop()}},e,this,[[0,9]])}));function t(){return e.apply(this,arguments)}return t}(),updateFood:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t,a,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.dialogFormVisible=!1,e.prev=1,t={newCategoryId:this.selectMenu.value,specs:this.specs},a=Object(i["a"])({},this.selectTable,t),e.next=6,Object(p["B"])(a);case 6:s=e.sent,this.$message({type:"success",message:s.message}),this.initData(),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](1),console.log("更新餐馆信息失败",e.t0);case 14:case"end":return e.stop()}},e,this,[[1,11]])}));function t(){return e.apply(this,arguments)}return t}(),setSort:function(){var e=this,t=this.$refs.dragTable.$el.querySelectorAll(".el-table__body-wrapper > table > tbody")[0];this.sortable=u["a"].create(t,{ghostClass:"sortable-ghost",setData:function(e){e.setData("Text","")},onEnd:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(a){var s,n,r,o;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(s=e.tableData[a.oldIndex],n=e.tableData[a.newIndex],r=e.tableData.splice(a.oldIndex,1)[0],e.tableData.splice(a.newIndex,0,r),a.newIndex===a.oldIndex){t.next=11;break}return t.next=7,Object(p["C"])(Object(i["a"])({},s,{newCategoryId:n.categoryId,newFoodId:n.foodId}));case 7:return o=t.sent,e.$message({type:"success",message:o.message}),t.next=11,e.initData();case 11:case"end":return t.stop()}},t)}));function a(e){return t.apply(this,arguments)}return a}()})}}},b=d,f=(a("5370"),a("39bc"),a("2877")),m=Object(f["a"])(b,s,n,!1,null,null,null);t["default"]=m.exports},e9ab:function(e,t,a){}}]);
//# sourceMappingURL=foodList.238c1df4.js.map